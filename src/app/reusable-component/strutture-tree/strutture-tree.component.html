

<!--  <dx-button (onClick)="apriRicerca()" text="Cerca"
 hint="Cerca le strutture"></dx-button>

  <dx-popup class="popup" [width]="600" [height]="670" [showTitle]="true" title="Associa a strutture" [dragEnabled]="false"
    [closeOnOutsideClick]="false" [(visible)]="popupRicercaVisible">
    <div *dxTemplate="let data of 'content'">
      <dx-text-box #textBox placeholder="Cerca" mode="search" valueChangeEvent="keyup"
             value="" style="margin-bottom:8px;"></dx-text-box>
      <dx-tree-view #treeViewRicerca id="simple-treeview" [dataSource]="datasource" [height]="440" keyExpr="id" displayExpr="nome"
        dataStructure="plain" parentIdExpr="idStrutturaPadre" [searchValue]="textBox.value"
         [disabled]= "false" [selectionMode]="single"
        (onClick)="handleEvent('onClickTreeViewRicerca',$event)"
        (onItemClick)="handleEvent('onItemClickTreeViewRicerca',$event)"
          [class]="getClassNewTree()">
      </dx-tree-view>
    </div>
  </dx-popup>
 -->


  <!-- <dx-text-box #textBox placeholder="Cerca" mode="search" valueChangeEvent="keyup"
             value="" style="margin-bottom:8px;"></dx-text-box>
 -->

 <div class="dx-field">
  <dx-lookup 
    id="lookupRicerca"
    [dataSource]="datasourceStrutture"
    [showPopupTitle]="false"
    cancelButtonText="Chiudi"
    closeOnOutsideClick="true"
    placeholder= "Seleziona..."
    searchPlaceholder= "Cerca..."
    [disabled]="false"
    displayExpr="nome"
    searchExpr="nome"
    [value]="this"
    (onOpened)="handleEvent('onOpenedLookupRicerca', $event)"
    (onSelectionChanged)="handleEvent('onSelectionChangedLookupRicerca', $event)"
    >
  </dx-lookup>
</div>

<div id="container-tree">
  <dx-tree-view #tree id="tree" 
    [dataSource]="datasource" 
    [height]="440"
    keyExpr="id" 
    displayExpr="nome"
    dataStructure="plain" parentIdExpr="idStrutturaPadre" [selectionMode]="single"
    showCheckBoxesMode="normal" [selectNodesRecursive]= "enableCheckRecursively" [disabled]= "disabled"
    (onItemContextMenu)="openContextMenu($event)" 
    (onClick)="handleEvent('onClickTree',$event)"
    (onItemSelectionChanged)="handleEvent('onItemSelectionChangedTree', $event)"
    (onItemClick)="handleEvent('onItemClickTree', $event)"
    (onOptionChanged)="handleEvent('onOptionChangedTree', $event)"
    (onItemExpanded)="handleEvent('onItemExpandedTree', $event)"
    (onItemCollapsed)="handleEvent('onItemCollapsedTree', $event)"
    (onContentReady)="handleEvent('onContentReadyTree', $event)"
    [class]="getClass()">
  </dx-tree-view> <!--[searchValue]="textBox.value"-->
</div>

<!-- (onContentReady)="handleEvent('onContentReady', $event)"  (onItemClick)="selezionaStruttura($event)"  (onOptionChanged)="handleEvent('onOptionChanged',$event)"-->


<dx-context-menu *ngIf="!readOnly"
  [dataSource]="contextMenuItems"
  [width]="200"
  target=".dx-treeview-item"
  (onItemClick)="contextualItemClick($event)">
</dx-context-menu>